import { PopoverDemos, HooksDemos } from '@docs/demos';
import { Layout } from '@/layout';
import { MDX_DATA } from '@/mdx';

export default Layout(MDX_DATA.EightToNine);

# 8.x → 9.x migration guide

## use-form TransformValues type

The second generic type of the `useForm` hook is now the type of transformed values
instead of the transform function type. New usage example:

```tsx
import { useForm } from '@mantine/form';

interface FormValues {
  name: string;
  locationId: string;
}

interface TransformedValues {
  name: string;
  locationId: number;
}

function Demo() {
  const form = useForm<FormValues, TransformedValues>({
    mode: 'uncontrolled',
    initialValues: {
      name: '',
      locationId: '2',
    },

    transformValues: (values) => ({
      ...values,
      locationId: Number(values.locationId),
    }),
  });
}
```

## Text color prop

The `color` prop of the [Text](/core/text) and [Anchor](/core/anchor) components was removed.
Use the `c` [style prop](/styles/style-props) instead:

```tsx
import { Text } from '@mantine/core';

// ❌ No longer works
function Demo() {
  return <Text color="red">Text</Text>;
}

// ✅ Use the c style prop
function Demo() {
  return <Text c="red">Text</Text>;
}
```

## Form resolvers

The `@mantine/form` package no longer exports schema resolvers; use [dedicated packages](/form/schema-validation/) instead:

Example with 8.x:

```tsx
import { z } from 'zod';
// ❌ No longer works; zodResolver is not exported from @mantine/form
import { useForm, zodResolver } from '@mantine/form';

const schema = z.object({
  email: z.string().email({ message: 'Invalid email' }),
});

const form = useForm({
  initialValues: {  email: '' },
  validate: zodResolver(schema),
});
```

Example with 9.x:

```tsx
import { z } from 'zod';
import { useForm } from '@mantine/form';
// ✅ Use a dedicated package for the zod resolver
import { zodResolver } from 'mantine-form-zod-resolver';

const schema = z.object({
  email: z.string().email({ message: 'Invalid email' }),
});

const form = useForm({
  initialValues: {  email: '' },
  validate: zodResolver(schema),
});
```

## TypographyStylesProvider

- The [TypographyStylesProvider](/core/typography) component was renamed to [Typography](/core/typography):

```tsx
// ❌ No longer works
import { TypographyStylesProvider } from '@mantine/core';

// ✅ Use the Typography component
import { Typography } from '@mantine/core';
```

## Popover and Tooltip positionDependencies prop

The [Popover](/core/popover) and [Tooltip](/core/tooltip) components no longer accept the `positionDependencies` prop; it is no longer required
– the position is now calculated automatically.

```tsx
import { Popover } from '@mantine/core';

// ❌ positionDependencies is no longer needed
function Demo(props) {
  return (
    <Popover position="top" positionDependencies={[props.a, props.b]}>
      {/* ... */}
    </Popover>
  );
}

// ✅ The position is recalculated automatically
function Demo(props) {
  return (
    <Popover position="top">
      {/* ... */}
    </Popover>
  );
}
```

## use-fullscreen hook changes

The [use-fullscreen](/hooks/use-fullscreen) hook was split into two hooks: `useFullscreenElement` and `useFullscreenDocument`.
This change was required to fix a stale ref issue in the previous implementation.

New usage with the `document` element:

<Demo data={HooksDemos.useFullscreenDemo} />

New usage with a custom target element:

<Demo data={HooksDemos.useFullscreenRefDemo} />

## use-mouse hook changes

The [use-mouse](/hooks/use-mouse) hook was split into two hooks: `useMouse` and `useMousePosition`.
This change was required to fix a stale ref issue in the previous implementation.

Previous usage with the `document` element:

```tsx
import { Text, Code } from '@mantine/core';
import { useMouse } from '@mantine/hooks';

function Demo() {
  const { x, y } = useMouse();

  return (
    <Text ta="center">
      Mouse coordinates <Code>{`{ x: ${x}, y: ${y} }`}</Code>
    </Text>
  );
}
```

New usage with `document`:

<Demo data={HooksDemos.useMouseUsage} />

## use-mutation-observer hook changes

The [use-mutation-observer](/hooks/use-mutation-observer) hook now uses the new callback ref approach.
This change was required to fix stale ref issues and improve compatibility with dynamic node changes.

Previous usage (8.x):

```tsx
import { useMutationObserver } from '@mantine/hooks';

useMutationObserver(
  (mutations) => console.log(mutations),
  { childList: true },
  // ❌ The third argument is no longer supported; use `useMutationObserverTarget` instead
  document.getElementById('external-element')
);
```

New usage (9.x):

```tsx
import { useMutationObserverTarget } from '@mantine/hooks';

// ✅ Rename the hook to `useMutationObserverTarget`
useMutationObserverTarget(
  (mutations) => console.log(mutations),
  { childList: true },
  // ✅ Pass the target element as the third argument
  document.getElementById('external-element')
);
```

## Rename hooks types

`@mantine/hooks` types were renamed for consistency; rename them in your codebase:
- `UseScrollSpyReturnType` → `UseScrollSpyReturnValue`
- `StateHistory` → `UseStateHistoryValue`
- `OS` → `UseOSReturnValue`

## Collapse in -> expanded

The [Collapse](/core/collapse) component now uses the `expanded` prop instead of `in`:

```tsx
import { Collapse } from '@mantine/core';

// ❌ No longer works
function Demo() {
  return (
    <Collapse in={false}>
      {/* ... */}
    </Collapse>
  );
}

// ✅ Use the expanded prop
function Demo() {
  return (
    <Collapse expanded={false}>
      {/* ... */}
    </Collapse>
  );
}
```

## Grid gutter -> gap

The [Grid](/core/grid) component `gutter` prop was renamed to `gap` for consistency with other layout components
(like [Flex](/core/flex) and [SimpleGrid](/core/simple-grid)). Additionally, new `rowGap` and `columnGap` props
were added to allow separate control of vertical and horizontal spacing:

```tsx
import { Grid } from '@mantine/core';

// ❌ No longer works
function Demo() {
  return (
    <Grid gutter="xl">
      <Grid.Col span={6}>1</Grid.Col>
      <Grid.Col span={6}>2</Grid.Col>
    </Grid>
  );
}

// ✅ Use the gap prop
function Demo() {
  return (
    <Grid gap="xl">
      <Grid.Col span={6}>1</Grid.Col>
      <Grid.Col span={6}>2</Grid.Col>
    </Grid>
  );
}

// ✅ New: Separate row and column gaps
function Demo() {
  return (
    <Grid rowGap="xl" columnGap="sm">
      <Grid.Col span={6}>1</Grid.Col>
      <Grid.Col span={6}>2</Grid.Col>
    </Grid>
  );
}
```
